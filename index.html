<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de Derivadas y Límites</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.20.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <style>/* tus estilos aquí */</style>
</head>
<body>
  <h1>Calculadora de Derivadas y Límites</h1>
  <label for="funcion">Ingresa una función f(x):</label>
  <input type="text" id="funcion" placeholder="Ej: (3*x^2 + 1)/(x - 2)">
  <button id="btnCalcular">Calcular Derivada</button>

  <div class="resultado" id="respuestaDirecta"></div>
  <div class="pasos" id="pasosDerivada"></div>
  <div class="pasos" id="pasosLimite"></div>
  <div class="resultado" id="tablaValores"></div>
  <div id="grafica"></div>

  <script>
    function nodeToLatex(node) {
      try {
        return node ? node.toTex({ parenthesis: 'keep', implicit: 'show' }) : '';
      } catch {
        return node ? node.toString() : '';
      }
    }

    function pasoAPasoGeneral(node, derivadaNode) {
      let html = `<p><strong>Paso a paso de la derivada</strong>:</p>`;
      html += `<p>Dada la función \\( f(x) = ${nodeToLatex(node)} \\):</p>`;
      html += `<ol>`;
      function pasosRecursivo(n, nivel = 0) {
        /* aquí va el contenido corregido usando backticks y ${...} como plantillas */
      }
      pasosRecursivo(node);
      html += `<li><strong>Resultado final simplificado:</strong><br>\\( f'(x) = ${nodeToLatex(derivadaNode)} \\)</li>`;
      html += `</ol>`;
      return html;
    }

    function calcularDerivada() {
      const exprInput = document.getElementById("funcion").value.trim();
      if (!exprInput) return alert("Por favor, ingresa una función válida.");

      let fNode;
      try {
        fNode = math.parse(exprInput);
      } catch {
        return alert("Función inválida. Revisa la sintaxis.");
      }

     
